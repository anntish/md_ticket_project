{"creation_time": "2025-12-13T08:21:15+00:00", "days_back": 7, "models": {"model.dbt_project.ods_ticket_offers": {"name": "ods_ticket_offers", "unique_id": "model.dbt_project.ods_ticket_offers", "owners": [], "tags": [], "package_name": "dbt_project", "description": "", "full_path": "models/ods/ods_ticket_offers.sql", "meta": {}, "materialization": "incremental", "database_name": "md_ticket", "schema_name": "ods", "table_name": "ods_ticket_offers", "patch_path": "dbt_project://models/ods/ods_schema.yml", "model_name": "ods_ticket_offers", "normalized_full_path": "dbt_project/models/ods/ods_ticket_offers.sql", "fqn": "md_ticket.ods.ods_ticket_offers", "artifact_type": "model"}, "model.dbt_project.my_first_dbt_model": {"name": "my_first_dbt_model", "unique_id": "model.dbt_project.my_first_dbt_model", "owners": [], "tags": [], "package_name": "dbt_project", "description": "A starter dbt model", "full_path": "models/example/my_first_dbt_model.sql", "meta": {}, "materialization": "table", "database_name": "md_ticket", "schema_name": "raw", "table_name": "my_first_dbt_model", "patch_path": "dbt_project://models/example/schema.yml", "model_name": "my_first_dbt_model", "normalized_full_path": "dbt_project/models/example/my_first_dbt_model.sql", "fqn": "md_ticket.raw.my_first_dbt_model", "artifact_type": "model"}, "model.dbt_project.my_second_dbt_model": {"name": "my_second_dbt_model", "unique_id": "model.dbt_project.my_second_dbt_model", "owners": [], "tags": [], "package_name": "dbt_project", "description": "A starter dbt model", "full_path": "models/example/my_second_dbt_model.sql", "meta": {}, "materialization": "view", "database_name": "md_ticket", "schema_name": "raw", "table_name": "my_second_dbt_model", "patch_path": "dbt_project://models/example/schema.yml", "model_name": "my_second_dbt_model", "normalized_full_path": "dbt_project/models/example/my_second_dbt_model.sql", "fqn": "md_ticket.raw.my_second_dbt_model", "artifact_type": "model"}, "model.dbt_project.dm_prices_agg_search_dep_route": {"name": "dm_prices_agg_search_dep_route", "unique_id": "model.dbt_project.dm_prices_agg_search_dep_route", "owners": [], "tags": ["dm"], "package_name": "dbt_project", "description": "", "full_path": "models/dm/dm_prices_agg_search_dep_route.sql", "meta": {}, "materialization": "table", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_agg_search_dep_route", "patch_path": "dbt_project://models/dm/dm_schema.yml", "model_name": "dm_prices_agg_search_dep_route", "normalized_full_path": "dbt_project/models/dm/dm_prices_agg_search_dep_route.sql", "fqn": "md_ticket.dm.dm_prices_agg_search_dep_route", "artifact_type": "model"}, "model.dbt_project.dm_prices_agg_route": {"name": "dm_prices_agg_route", "unique_id": "model.dbt_project.dm_prices_agg_route", "owners": [], "tags": ["dm"], "package_name": "dbt_project", "description": "", "full_path": "models/dm/dm_prices_agg_route.sql", "meta": {}, "materialization": "table", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_agg_route", "patch_path": "dbt_project://models/dm/dm_schema.yml", "model_name": "dm_prices_agg_route", "normalized_full_path": "dbt_project/models/dm/dm_prices_agg_route.sql", "fqn": "md_ticket.dm.dm_prices_agg_route", "artifact_type": "model"}, "model.dbt_project.dm_fact_ticket_offers": {"name": "dm_fact_ticket_offers", "unique_id": "model.dbt_project.dm_fact_ticket_offers", "owners": [], "tags": ["dm"], "package_name": "dbt_project", "description": "", "full_path": "models/dm/dm_fact_ticket_offers.sql", "meta": {}, "materialization": "incremental", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "patch_path": "dbt_project://models/dm/dm_schema.yml", "model_name": "dm_fact_ticket_offers", "normalized_full_path": "dbt_project/models/dm/dm_fact_ticket_offers.sql", "fqn": "md_ticket.dm.dm_fact_ticket_offers", "artifact_type": "model"}, "model.dbt_project.dm_prices_agg_dep_route": {"name": "dm_prices_agg_dep_route", "unique_id": "model.dbt_project.dm_prices_agg_dep_route", "owners": [], "tags": ["dm"], "package_name": "dbt_project", "description": "", "full_path": "models/dm/dm_prices_agg_dep_route.sql", "meta": {}, "materialization": "table", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_agg_dep_route", "patch_path": "dbt_project://models/dm/dm_schema.yml", "model_name": "dm_prices_agg_dep_route", "normalized_full_path": "dbt_project/models/dm/dm_prices_agg_dep_route.sql", "fqn": "md_ticket.dm.dm_prices_agg_dep_route", "artifact_type": "model"}, "model.dbt_project.dm_prices_latest": {"name": "dm_prices_latest", "unique_id": "model.dbt_project.dm_prices_latest", "owners": [], "tags": ["dm"], "package_name": "dbt_project", "description": "", "full_path": "models/dm/dm_prices_latest.sql", "meta": {}, "materialization": "incremental", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_latest", "patch_path": "dbt_project://models/dm/dm_schema.yml", "model_name": "dm_prices_latest", "normalized_full_path": "dbt_project/models/dm/dm_prices_latest.sql", "fqn": "md_ticket.dm.dm_prices_latest", "artifact_type": "model"}, "model.dbt_project.dm_airports": {"name": "dm_airports", "unique_id": "model.dbt_project.dm_airports", "owners": [], "tags": ["dm"], "package_name": "dbt_project", "description": "", "full_path": "models/dm/dm_airports.sql", "meta": {}, "materialization": "table", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_airports", "patch_path": "dbt_project://models/dm/dm_schema.yml", "model_name": "dm_airports", "normalized_full_path": "dbt_project/models/dm/dm_airports.sql", "fqn": "md_ticket.dm.dm_airports", "artifact_type": "model"}, "model.dbt_project.stg_ticket_offers": {"name": "stg_ticket_offers", "unique_id": "model.dbt_project.stg_ticket_offers", "owners": [], "tags": [], "package_name": "dbt_project", "description": "", "full_path": "models/stg/stg_ticket_offers.sql", "meta": {}, "materialization": "table", "database_name": "md_ticket", "schema_name": "stg", "table_name": "stg_ticket_offers", "patch_path": "dbt_project://models/stg/stg_schema.yml", "model_name": "stg_ticket_offers", "normalized_full_path": "dbt_project/models/stg/stg_ticket_offers.sql", "fqn": "md_ticket.stg.stg_ticket_offers", "artifact_type": "model"}, "source.dbt_project.raw_data.aviasales_api_log": {"name": "aviasales_api_log", "unique_id": "source.dbt_project.raw_data.aviasales_api_log", "owners": [], "tags": [], "package_name": "dbt_project", "description": "", "full_path": "models/sources.yml", "meta": {}, "materialization": null, "source_name": "raw_data", "database_name": "md_ticket", "schema_name": "raw", "table_name": "aviasales_api_log", "model_name": "aviasales_api_log", "normalized_full_path": "dbt_project/sources/sources.yml", "fqn": "md_ticket.raw.aviasales_api_log", "artifact_type": "source"}}, "groups": {"dbt": {"dbt_project": {"models": {"ods": {"__files__": [{"node_id": "model.dbt_project.ods_ticket_offers", "resource_type": "model"}]}, "example": {"__files__": [{"node_id": "model.dbt_project.my_first_dbt_model", "resource_type": "model"}, {"node_id": "model.dbt_project.my_second_dbt_model", "resource_type": "model"}]}, "dm": {"__files__": [{"node_id": "model.dbt_project.dm_prices_agg_search_dep_route", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_prices_agg_route", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_fact_ticket_offers", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_prices_agg_dep_route", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_prices_latest", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_airports", "resource_type": "model"}]}, "stg": {"__files__": [{"node_id": "model.dbt_project.stg_ticket_offers", "resource_type": "model"}]}}, "sources": {"__files__": [{"node_id": "source.dbt_project.raw_data.aviasales_api_log", "resource_type": "source"}]}}}, "tags": {"No tags": [{"node_id": "model.dbt_project.ods_ticket_offers", "resource_type": "model"}, {"node_id": "model.dbt_project.my_first_dbt_model", "resource_type": "model"}, {"node_id": "model.dbt_project.my_second_dbt_model", "resource_type": "model"}, {"node_id": "model.dbt_project.stg_ticket_offers", "resource_type": "model"}, {"node_id": "source.dbt_project.raw_data.aviasales_api_log", "resource_type": "source"}], "dm": [{"node_id": "model.dbt_project.dm_prices_agg_search_dep_route", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_prices_agg_route", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_fact_ticket_offers", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_prices_agg_dep_route", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_prices_latest", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_airports", "resource_type": "model"}]}, "owners": {"No owners": [{"node_id": "model.dbt_project.ods_ticket_offers", "resource_type": "model"}, {"node_id": "model.dbt_project.my_first_dbt_model", "resource_type": "model"}, {"node_id": "model.dbt_project.my_second_dbt_model", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_prices_agg_search_dep_route", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_prices_agg_route", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_fact_ticket_offers", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_prices_agg_dep_route", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_prices_latest", "resource_type": "model"}, {"node_id": "model.dbt_project.dm_airports", "resource_type": "model"}, {"node_id": "model.dbt_project.stg_ticket_offers", "resource_type": "model"}, {"node_id": "source.dbt_project.raw_data.aviasales_api_log", "resource_type": "source"}]}}, "invocation": {"invocation_id": null, "detected_at": null, "command": null, "selected": null, "full_refresh": null, "job_url": null, "job_name": null, "job_id": null, "orchestrator": null}, "test_results": {"model.dbt_project.stg_ticket_offers": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_stg_ticket_offers_request.a705032bb7", "elementary_unique_id": "test.dbt_project.not_null_stg_ticket_offers_request.a705032bb7.request.generic", "database_name": "md_ticket", "schema_name": "stg", "table_name": "stg_ticket_offers", "column_name": "request", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.stg_ticket_offers", "table_unique_id": "md_ticket.stg.stg_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select request\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere request is null", "test_params": {"column_name": "request", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select request\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere request is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "request", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": null, "error_message": null, "failed_rows_count": -1}}, {"metadata": {"test_unique_id": "test.dbt_project.not_null_stg_ticket_offers_response.51dbe8795c", "elementary_unique_id": "test.dbt_project.not_null_stg_ticket_offers_response.51dbe8795c.response.generic", "database_name": "md_ticket", "schema_name": "stg", "table_name": "stg_ticket_offers", "column_name": "response", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.stg_ticket_offers", "table_unique_id": "md_ticket.stg.stg_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select response\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere response is null", "test_params": {"column_name": "response", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select response\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere response is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "response", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": null, "error_message": null, "failed_rows_count": -1}}, {"metadata": {"test_unique_id": "test.dbt_project.unique_stg_ticket_offers_aviasales_id.e16a27efc3", "elementary_unique_id": "test.dbt_project.unique_stg_ticket_offers_aviasales_id.e16a27efc3.aviasales_id.generic", "database_name": "md_ticket", "schema_name": "stg", "table_name": "stg_ticket_offers", "column_name": "aviasales_id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.stg_ticket_offers", "table_unique_id": "md_ticket.stg.stg_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select\n    aviasales_id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere aviasales_id is not null\ngroup by aviasales_id\nhaving count(*) > 1", "test_params": {"column_name": "aviasales_id", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select\n    aviasales_id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere aviasales_id is not null\ngroup by aviasales_id\nhaving count(*) > 1"}, "configuration": {"test_name": "unique", "test_params": {"column_name": "aviasales_id", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}}}, "test_results": {"display_name": "unique", "results_sample": null, "error_message": null, "failed_rows_count": -1}}], "model.dbt_project.dm_airports": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_dm_airports_airport_code.972fe3f0e8", "elementary_unique_id": "test.dbt_project.not_null_dm_airports_airport_code.972fe3f0e8.airport_code.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_airports", "column_name": "airport_code", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_airports", "table_unique_id": "md_ticket.dm.dm_airports", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select airport_code\nfrom \"md_ticket\".\"dm\".\"dm_airports\"\nwhere airport_code is null", "test_params": {"column_name": "airport_code", "model": "{{ get_where_subquery(ref('dm_airports')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select airport_code\nfrom \"md_ticket\".\"dm\".\"dm_airports\"\nwhere airport_code is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "airport_code", "model": "{{ get_where_subquery(ref('dm_airports')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": null, "error_message": null, "failed_rows_count": -1}}], "model.dbt_project.dm_fact_ticket_offers": [{"metadata": {"test_unique_id": "test.dbt_project.dbt_utils_accepted_range_dm_fact_ticket_offers_price_rub__0.438f520265", "elementary_unique_id": "test.dbt_project.dbt_utils_accepted_range_dm_fact_ticket_offers_price_rub__0.438f520265.price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": "price_rub", "test_name": "accepted_range", "test_display_name": "Accepted Range", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "with meet_condition as(\n  select *\n  from \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not price_rub >= 0\n)\n\nselect *\nfrom validation_errors", "test_params": {"min_value": 0, "column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "with meet_condition as(\n  select *\n  from \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not price_rub >= 0\n)\n\nselect *\nfrom validation_errors"}, "configuration": {"test_name": "accepted_range", "test_params": {"min_value": 0, "column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}}}, "test_results": {"display_name": "accepted_range", "results_sample": null, "error_message": null, "failed_rows_count": -1}}, {"metadata": {"test_unique_id": "test.dbt_project.elementary_column_anomalies_dm_fact_ticket_offers_price_rub__hour__12__day__14__hour__12.4d8a967773", "elementary_unique_id": "test.dbt_project.elementary_column_anomalies_dm_fact_ticket_offers_price_rub__hour__12__day__14__hour__12.4d8a967773.price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": "price_rub", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_4d8a967773_eleme__anomaly_scores__tmp_20251213082051764838\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"time_bucket": {"period": "hour", "count": 12}, "detection_period": {"period": "day", "count": 14}, "detection_delay": {"period": "hour", "count": 12}, "column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_4d8a967773_eleme__anomaly_scores__tmp_20251213082051764838\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "12 hours", "anomaly_threshold": null}}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}, {"metadata": {"test_unique_id": "test.dbt_project.elementary_dimension_anomalies_dm_fact_ticket_offers_hour__12__day__14__status_code__endpoint__currency__price_bucket__transfers_cnt__is_direct__hour__12.3d7b158c6b", "elementary_unique_id": "test.dbt_project.elementary_dimension_anomalies_dm_fact_ticket_offers_hour__12__day__14__status_code__endpoint__currency__price_bucket__transfers_cnt__is_direct__hour__12.3d7b158c6b", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": null, "test_name": "dimension_anomalies", "test_display_name": "Dimension Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_3d7b158c6b_eleme__anomaly_scores__tmp_20251213082051903719\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"dimensions": ["status_code", "endpoint", "currency", "price_bucket", "transfers_cnt", "is_direct"], "time_bucket": {"period": "hour", "count": 12}, "detection_period": {"period": "day", "count": 14}, "detection_delay": {"period": "hour", "count": 12}, "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_3d7b158c6b_eleme__anomaly_scores__tmp_20251213082051903719\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "dimension_anomalies", "timestamp_column": null, "testing_timeframe": "12 hours", "anomaly_threshold": null}}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}, {"metadata": {"test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "elementary_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e.None.event_freshness", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": null, "test_name": "event_freshness_anomalies", "test_display_name": "Event Freshness Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "anomaly_detection", "test_sub_type": "event_freshness", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_FACT_TICKET_OFFERS' as varchar(4096))) and\n        metric_name = cast('event_freshness' as varchar(4096))", "test_params": {"event_timestamp_column": "created_at", "update_timestamp_column": "processed_src_dttm", "time_bucket": {"period": "hour", "count": 12}, "detection_delay": {"period": "hour", "count": 12}, "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}", "timestamp_column": "processed_src_dttm", "where_expression": null, "freshness_column": null, "dimensions": null, "days_back": 14, "backfill_days": 2, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1", "exclude_detection_period_from_training": null}, "test_created_at": null, "description": null, "result": {"result_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_FACT_TICKET_OFFERS' as varchar(4096))) and\n        metric_name = cast('event_freshness' as varchar(4096))"}, "configuration": {"test_name": "event_freshness_anomalies", "timestamp_column": "processed_src_dttm", "testing_timeframe": "12 hours", "anomaly_threshold": 3}}, "test_results": {"display_name": "Event Freshness", "metrics": [{"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-11-28T12:00:00", "end_time": "2025-11-29T00:00:00", "id": "39a6a46ab58aa36d5fedb376ff7ffb39", "metric_id": "a33323ab237149b7515bae991c72ffd4", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-28T12:00:00", "bucket_end": "2025-11-29T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 2, "training_start": "2025-11-28T12:00:00", "training_end": "2025-11-29T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-11-29T00:00:00", "end_time": "2025-11-29T12:00:00", "id": "f4bfe3a2c205829766846aa3283e8a30", "metric_id": "5987f8d14ec80d66a5a3d03f8d905d14", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-29T00:00:00", "bucket_end": "2025-11-29T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 3, "training_start": "2025-11-28T12:00:00", "training_end": "2025-11-29T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-11-29T12:00:00", "end_time": "2025-11-30T00:00:00", "id": "fef9a104a10e86222aabf852ceb6c78e", "metric_id": "d54a93b6acdd0853b14f76e3a43248d9", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-29T12:00:00", "bucket_end": "2025-11-30T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 4, "training_start": "2025-11-28T12:00:00", "training_end": "2025-11-30T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-11-30T00:00:00", "end_time": "2025-11-30T12:00:00", "id": "a753a2541cf968d910864e4e30c1f24c", "metric_id": "d74193d0930ea54ca5a87ebacabcab55", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-30T00:00:00", "bucket_end": "2025-11-30T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 5, "training_start": "2025-11-28T12:00:00", "training_end": "2025-11-30T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-11-30T12:00:00", "end_time": "2025-12-01T00:00:00", "id": "9bd8d3585cd9f98a5deb235bb136c2d9", "metric_id": "828dcd159f5195dbf4ab128e9948776d", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-30T12:00:00", "bucket_end": "2025-12-01T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 6, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-01T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-01T00:00:00", "end_time": "2025-12-01T12:00:00", "id": "6fe1f5ecb3841b07ced36fa972b26389", "metric_id": "088cc9e6e5525b936c3d007b474ffe0b", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-01T00:00:00", "bucket_end": "2025-12-01T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 7, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-01T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-01T12:00:00", "end_time": "2025-12-02T00:00:00", "id": "e1f62c9072e55fc2ac21e83a3f2df8e4", "metric_id": "b4a3290e5c8ea06ad6ecc3924aa9dab5", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-01T12:00:00", "bucket_end": "2025-12-02T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 8, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-02T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-02T00:00:00", "end_time": "2025-12-02T12:00:00", "id": "380d84287c161aa3c6c23d155179d18b", "metric_id": "30f4227e3839c6009ea63d0d2fda53f7", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-02T00:00:00", "bucket_end": "2025-12-02T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 9, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-02T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-02T12:00:00", "end_time": "2025-12-03T00:00:00", "id": "a248ab07c95c2b16ab3777703f5433e4", "metric_id": "46cf470656804245c22b2e18ba1934a7", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-02T12:00:00", "bucket_end": "2025-12-03T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 10, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-03T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-03T00:00:00", "end_time": "2025-12-03T12:00:00", "id": "47e8991b5453eaa634b3ae503f4452e1", "metric_id": "cb6e382ae6fd50b3974bf71a2f511a27", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-03T00:00:00", "bucket_end": "2025-12-03T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 11, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-03T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-03T12:00:00", "end_time": "2025-12-04T00:00:00", "id": "5d2a9097236a388a1323f4eb58f24bb7", "metric_id": "f8e319d4d8c4630a2d5d3231beaf4ae9", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-03T12:00:00", "bucket_end": "2025-12-04T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 12, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-04T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-04T00:00:00", "end_time": "2025-12-04T12:00:00", "id": "ffb0bb1855da1d01d8d6af24a5825846", "metric_id": "45c0b9e043d44bb77e2838a6a389d933", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-04T00:00:00", "bucket_end": "2025-12-04T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 13, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-04T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-04T12:00:00", "end_time": "2025-12-05T00:00:00", "id": "673d70db30422f9f64453c2f63f0be71", "metric_id": "35c1bee565726e2c2abd7d7e66ddddcf", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-04T12:00:00", "bucket_end": "2025-12-05T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 14, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-05T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-05T00:00:00", "end_time": "2025-12-05T12:00:00", "id": "c74248cbbe5b65d2855b5eb7250d9aea", "metric_id": "1d9e1240bd6272a480580c29cf06c99e", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-05T00:00:00", "bucket_end": "2025-12-05T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 15, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-05T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-05T12:00:00", "end_time": "2025-12-06T00:00:00", "id": "2c3eee227770aad7740fa8648296250f", "metric_id": "d5734c2113c195417bd823f23bfa630d", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-05T12:00:00", "bucket_end": "2025-12-06T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 16, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-06T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-06T00:00:00", "end_time": "2025-12-06T12:00:00", "id": "c5024dfa607452041044e546de8c5d8f", "metric_id": "500e59ab09abbd810370f8cf80f5b883", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-06T00:00:00", "bucket_end": "2025-12-06T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 17, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-06T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-06T12:00:00", "end_time": "2025-12-07T00:00:00", "id": "f45d3f549ed70f5616ebc17c1bbd0213", "metric_id": "83e388358c7a8a916882459d8e8d73e1", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-06T12:00:00", "bucket_end": "2025-12-07T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 18, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-07T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-07T00:00:00", "end_time": "2025-12-07T12:00:00", "id": "f0b30286f956213306aab8e0d6c4e055", "metric_id": "3e6c0057b90e9bc8e1e84c8e775608e4", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-07T00:00:00", "bucket_end": "2025-12-07T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 19, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-07T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-07T12:00:00", "end_time": "2025-12-08T00:00:00", "id": "c0de0a6e5a4cd18a77525aae5973743d", "metric_id": "2babcfba284c1a9841aeae119684d1d2", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-07T12:00:00", "bucket_end": "2025-12-08T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 20, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-08T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-08T00:00:00", "end_time": "2025-12-08T12:00:00", "id": "22d032c108821abfce507d3b46e785fb", "metric_id": "047cf14591627ce2a57af2c5216e1ce8", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-08T00:00:00", "bucket_end": "2025-12-08T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 21, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-08T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-08T12:00:00", "end_time": "2025-12-09T00:00:00", "id": "a7fe9139d62abe582e1e248d6c27f51e", "metric_id": "4fb3e935ebf7e6e0e3b98816b361f16c", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-08T12:00:00", "bucket_end": "2025-12-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 22, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-09T00:00:00", "end_time": "2025-12-09T12:00:00", "id": "7647da37eaf42d8a3ced9a7b640dad5a", "metric_id": "2736dbb7d8b07cd134f70427d14e76d3", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-09T00:00:00", "bucket_end": "2025-12-09T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 23, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-09T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-09T12:00:00", "end_time": "2025-12-10T00:00:00", "id": "de3e2965afe54320b79b7e64059c167d", "metric_id": "c5ab02606da3c617822ca7145f0f43dc", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-09T12:00:00", "bucket_end": "2025-12-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 24, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-10T00:00:00", "end_time": "2025-12-10T12:00:00", "id": "155a083f46e151a904fe5bb66e3e17ce", "metric_id": "1b9f3a451d97f8ce01bee4a3e50305a5", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-10T00:00:00", "bucket_end": "2025-12-10T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 25, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-10T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-10T12:00:00", "end_time": "2025-12-11T00:00:00", "id": "d42d65917e24343a71ccfe8031e0232c", "metric_id": "2516b0ab40ebe9355727114a63106d00", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-10T12:00:00", "bucket_end": "2025-12-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 26, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-11T00:00:00", "end_time": "2025-12-11T12:00:00", "id": "bd54638910db10cbca5f744615a7684d", "metric_id": "af77cbc16bf866c8383c56e4f16fd867", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-11T00:00:00", "bucket_end": "2025-12-11T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 27, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-11T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-11T12:00:00", "end_time": "2025-12-12T00:00:00", "id": "592a9f5aaa434c605e320bf5a9f61ffc", "metric_id": "d38b36b2a8c0716e1c56cc6c9cf38e0c", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-11T12:00:00", "bucket_end": "2025-12-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 28, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 43200.0, "average": 43200.0, "min_value": 43200.0, "max_value": 43200.0, "start_time": "2025-12-12T00:00:00", "end_time": "2025-12-12T12:00:00", "id": "cb421399578951d00986274c1e2e7f6b", "metric_id": "3b313bad06dee3a692cf5effde622e01", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "detected_at": "2025-12-13T08:20:51.995416", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "event_freshness", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-12T00:00:00", "bucket_end": "2025-12-12T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 43200.0, "min_metric_value": 43200.0, "max_metric_value": 43200.0, "training_avg": 43200.0, "training_stddev": 0, "training_set_size": 29, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-12T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}], "result_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000."}}, {"metadata": {"test_unique_id": "test.dbt_project.elementary_freshness_anomalies_dm_fact_ticket_offers_hour__12__day__7__hour__12.c57efa20b0", "elementary_unique_id": "test.dbt_project.elementary_freshness_anomalies_dm_fact_ticket_offers_hour__12__day__7__hour__12.c57efa20b0.None.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": null, "test_name": "freshness_anomalies", "test_display_name": "Freshness Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_c57efa20b0_eleme__anomaly_scores__tmp_20251213082052122536\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-7' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"time_bucket": {"period": "hour", "count": 12}, "detection_period": {"period": "day", "count": 7}, "detection_delay": {"period": "hour", "count": 12}, "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_c57efa20b0_eleme__anomaly_scores__tmp_20251213082052122536\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-7' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "freshness_anomalies", "timestamp_column": null, "testing_timeframe": "12 hours", "anomaly_threshold": null}}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}, {"metadata": {"test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "elementary_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df.None.row_count", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_FACT_TICKET_OFFERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"time_bucket": {"period": "hour", "count": 12}, "detection_period": {"period": "day", "count": 14}, "detection_delay": {"period": "hour", "count": 12}, "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}", "timestamp_column": "created_at", "where_expression": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "days_back": 14, "backfill_days": 14, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1", "exclude_detection_period_from_training": null}, "test_created_at": null, "description": null, "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_FACT_TICKET_OFFERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "created_at", "testing_timeframe": "12 hours", "anomaly_threshold": 3}}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-11-28T12:00:00", "end_time": "2025-11-29T00:00:00", "id": "1a639ea684ef60f4b73341a806e5b979", "metric_id": "efea47758f095c61e1f73cf13460072c", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-28T12:00:00", "bucket_end": "2025-11-29T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 2, "training_start": "2025-11-28T12:00:00", "training_end": "2025-11-29T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-11-29T00:00:00", "end_time": "2025-11-29T12:00:00", "id": "a2e0ed3d5acab7afaa19e0a33df68149", "metric_id": "0d1474228e2d15af9d5be274ff055596", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-29T00:00:00", "bucket_end": "2025-11-29T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 3, "training_start": "2025-11-28T12:00:00", "training_end": "2025-11-29T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-11-29T12:00:00", "end_time": "2025-11-30T00:00:00", "id": "8bbfdb55f1f279d0da8974668f60ed41", "metric_id": "495cb032c2c94d1a7f0338e5eecf4089", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-29T12:00:00", "bucket_end": "2025-11-30T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 4, "training_start": "2025-11-28T12:00:00", "training_end": "2025-11-30T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-11-30T00:00:00", "end_time": "2025-11-30T12:00:00", "id": "d286b0ebeae18a27df093373c3b77a33", "metric_id": "11e9309bee4a095be417ba21edd846c0", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-30T00:00:00", "bucket_end": "2025-11-30T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 5, "training_start": "2025-11-28T12:00:00", "training_end": "2025-11-30T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-11-30T12:00:00", "end_time": "2025-12-01T00:00:00", "id": "f35983dfdcfb6883aa579cefee3c49d5", "metric_id": "0b74255a4a94ebec220ab087b4737189", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-30T12:00:00", "bucket_end": "2025-12-01T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 6, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-01T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-01T00:00:00", "end_time": "2025-12-01T12:00:00", "id": "b35f0a7dfb3d45501b7775c6b4de47a9", "metric_id": "307886f4201e2ee0c278b7c264bee954", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-01T00:00:00", "bucket_end": "2025-12-01T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 7, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-01T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-01T12:00:00", "end_time": "2025-12-02T00:00:00", "id": "9f9e6d4bf5b761d4a1b590ffc6366bf2", "metric_id": "0668f274cbb144b17eef8f7965356010", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-01T12:00:00", "bucket_end": "2025-12-02T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 8, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-02T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-02T00:00:00", "end_time": "2025-12-02T12:00:00", "id": "03a9821b202e483c12de75ae7667d207", "metric_id": "ec61cfb0333dd5b8ec92c4f124e257ff", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-02T00:00:00", "bucket_end": "2025-12-02T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 9, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-02T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-02T12:00:00", "end_time": "2025-12-03T00:00:00", "id": "d266f214caa5535b7af395a417e955a4", "metric_id": "16033e7a2b2eae1d1e0a942552e5e128", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-02T12:00:00", "bucket_end": "2025-12-03T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 10, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-03T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-03T00:00:00", "end_time": "2025-12-03T12:00:00", "id": "6407077858ce08f1ef9ff8b04d8a769d", "metric_id": "1f9272e18f72ca814bfb82717c61e1be", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-03T00:00:00", "bucket_end": "2025-12-03T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 11, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-03T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-03T12:00:00", "end_time": "2025-12-04T00:00:00", "id": "178d948837eac8bf3d13b54a573ff83b", "metric_id": "0e8986e62b6fcfaafc7e51d9bbe58726", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-03T12:00:00", "bucket_end": "2025-12-04T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 12, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-04T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-04T00:00:00", "end_time": "2025-12-04T12:00:00", "id": "8a599b14dfce0571ba042f7930b552ce", "metric_id": "859cdc29a64268551abefcb876d66c7f", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-04T00:00:00", "bucket_end": "2025-12-04T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 13, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-04T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-04T12:00:00", "end_time": "2025-12-05T00:00:00", "id": "62f3b154c948ba96da7f684f1c6c1dbe", "metric_id": "a9b8b3cb4c8b163f96bca612452de857", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-04T12:00:00", "bucket_end": "2025-12-05T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 14, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-05T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-05T00:00:00", "end_time": "2025-12-05T12:00:00", "id": "3a5ca6b3c24b49e6bf6e6293878ffb31", "metric_id": "793a3780b3910465f2e1899382020c57", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-05T00:00:00", "bucket_end": "2025-12-05T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 15, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-05T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-05T12:00:00", "end_time": "2025-12-06T00:00:00", "id": "a3e73136bfbdb52f5f4869d9e96f7cd5", "metric_id": "799c45fc74ce81e21d9d7ed98169c9d6", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-05T12:00:00", "bucket_end": "2025-12-06T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 16, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-06T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-06T00:00:00", "end_time": "2025-12-06T12:00:00", "id": "bb13eb7bffcce943f830e4797efe35d3", "metric_id": "3f17fb5f7136c581042d4777ac2cd28a", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-06T00:00:00", "bucket_end": "2025-12-06T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 17, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-06T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-06T12:00:00", "end_time": "2025-12-07T00:00:00", "id": "2289ea1584c985a1bc7ffde1b4207ee8", "metric_id": "a77d2426b6bd313daddf4e56f6903ab4", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-06T12:00:00", "bucket_end": "2025-12-07T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 18, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-07T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-07T00:00:00", "end_time": "2025-12-07T12:00:00", "id": "00cd695792de1d0c55bdb204648e78c2", "metric_id": "2f6b6bd2d21c3f1d5eb23fca5e98f56c", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-07T00:00:00", "bucket_end": "2025-12-07T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 19, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-07T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-07T12:00:00", "end_time": "2025-12-08T00:00:00", "id": "fc909f211f9caa88aaa0c89f85e7e707", "metric_id": "2aa20ec602b39a3c30da909e4eac90b2", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-07T12:00:00", "bucket_end": "2025-12-08T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 20, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-08T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-08T00:00:00", "end_time": "2025-12-08T12:00:00", "id": "10e799a74e3cd79b267d22d98fcbc104", "metric_id": "69a7d34b06cd88bb10d072c130811b7d", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-08T00:00:00", "bucket_end": "2025-12-08T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 21, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-08T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-08T12:00:00", "end_time": "2025-12-09T00:00:00", "id": "ba1c9099703c1a579bbcebeabab7e5d5", "metric_id": "12e910b294cb2ddc6aac3e7d9aabb364", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-08T12:00:00", "bucket_end": "2025-12-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 22, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-09T00:00:00", "end_time": "2025-12-09T12:00:00", "id": "027385012ab3006d79d1ceb2241ee5bc", "metric_id": "cb68edcd14b004cf7eefa2f321565b06", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-09T00:00:00", "bucket_end": "2025-12-09T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 23, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-09T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-09T12:00:00", "end_time": "2025-12-10T00:00:00", "id": "3f67718be41d16f223c1adeb0cadef89", "metric_id": "3b8f2fd587c45159689b01ff049d19b7", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-09T12:00:00", "bucket_end": "2025-12-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 24, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-10T00:00:00", "end_time": "2025-12-10T12:00:00", "id": "67d4ae908d44535be0a5a1f36dca11a8", "metric_id": "30921160f60834b50827454c6b04b49d", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-10T00:00:00", "bucket_end": "2025-12-10T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 25, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-10T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-10T12:00:00", "end_time": "2025-12-11T00:00:00", "id": "d8c91fc6e267198b9e12dda56019baf3", "metric_id": "6c73433f75dc1488a29e9923cfd3c5a6", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-10T12:00:00", "bucket_end": "2025-12-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 26, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-11T00:00:00", "end_time": "2025-12-11T12:00:00", "id": "13e36a2bf37b196b015a490ed0556730", "metric_id": "b0d618d207e1589ec31c8d5e47bd17d6", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-11T00:00:00", "bucket_end": "2025-12-11T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 27, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-11T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-11T12:00:00", "end_time": "2025-12-12T00:00:00", "id": "217135b8b4258611e26f94032d23f896", "metric_id": "66707bb79f0e866d0ab270c7f6edacdf", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-11T12:00:00", "bucket_end": "2025-12-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 28, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-12T00:00:00", "end_time": "2025-12-12T12:00:00", "id": "91db1487cd5c0ace08349104e5eae8e2", "metric_id": "8b2f3ad016229bec3cf090c41ab0db47", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "detected_at": "2025-12-13T08:20:52.180082", "full_table_name": "MD_TICKET.DM.DM_FACT_TICKET_OFFERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-12T00:00:00", "bucket_end": "2025-12-12T12:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 29, "training_start": "2025-11-28T12:00:00", "training_end": "2025-12-12T12:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-12T12:00:00", "is_anomalous": false}], "result_description": "The last row_count value is 0.000. The average for this metric is 0.000."}}, {"metadata": {"test_unique_id": "test.dbt_project.not_null_dm_fact_ticket_offers_price_rub.37637f5b0b", "elementary_unique_id": "test.dbt_project.not_null_dm_fact_ticket_offers_price_rub.37637f5b0b.price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": "price_rub", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select price_rub\nfrom \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\nwhere price_rub is null", "test_params": {"column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select price_rub\nfrom \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\nwhere price_rub is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": null, "error_message": null, "failed_rows_count": -1}}], "model.dbt_project.my_first_dbt_model": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710", "elementary_unique_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710.id.generic", "database_name": "md_ticket", "schema_name": "raw", "table_name": "my_first_dbt_model", "column_name": "id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "fail", "model_unique_id": "model.dbt_project.my_first_dbt_model", "table_unique_id": "md_ticket.raw.my_first_dbt_model", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select id\nfrom \"md_ticket\".\"raw\".\"my_first_dbt_model\"\nwhere id is null", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": "Got 1 result, configured to fail if != 0", "result_query": "select id\nfrom \"md_ticket\".\"raw\".\"my_first_dbt_model\"\nwhere id is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": [], "error_message": "Got 1 result, configured to fail if != 0", "failed_rows_count": 1}}, {"metadata": {"test_unique_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321", "elementary_unique_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321.id.generic", "database_name": "md_ticket", "schema_name": "raw", "table_name": "my_first_dbt_model", "column_name": "id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.my_first_dbt_model", "table_unique_id": "md_ticket.raw.my_first_dbt_model", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"raw\".\"my_first_dbt_model\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"raw\".\"my_first_dbt_model\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1"}, "configuration": {"test_name": "unique", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}}}, "test_results": {"display_name": "unique", "results_sample": null, "error_message": null, "failed_rows_count": -1}}], "model.dbt_project.dm_prices_agg_route": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_dm_prices_agg_route_avg_price_rub.7834ad96ee", "elementary_unique_id": "test.dbt_project.not_null_dm_prices_agg_route_avg_price_rub.7834ad96ee.avg_price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_agg_route", "column_name": "avg_price_rub", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_agg_route", "table_unique_id": "md_ticket.dm.dm_prices_agg_route", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select avg_price_rub\nfrom \"md_ticket\".\"dm\".\"dm_prices_agg_route\"\nwhere avg_price_rub is null", "test_params": {"column_name": "avg_price_rub", "model": "{{ get_where_subquery(ref('dm_prices_agg_route')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select avg_price_rub\nfrom \"md_ticket\".\"dm\".\"dm_prices_agg_route\"\nwhere avg_price_rub is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "avg_price_rub", "model": "{{ get_where_subquery(ref('dm_prices_agg_route')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": null, "error_message": null, "failed_rows_count": -1}}], "model.dbt_project.dm_prices_agg_dep_route": [{"metadata": {"test_unique_id": "test.dbt_project.elementary_column_anomalies_dm_prices_agg_dep_route_avg_price_rub__day__7__day__1.8dc82d391b", "elementary_unique_id": "test.dbt_project.elementary_column_anomalies_dm_prices_agg_dep_route_avg_price_rub__day__7__day__1.8dc82d391b.avg_price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_agg_dep_route", "column_name": "avg_price_rub", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_agg_dep_route", "table_unique_id": "md_ticket.dm.dm_prices_agg_dep_route", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_8dc82d391b_eleme__anomaly_scores__tmp_20251213082051831781\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-7' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"time_bucket": {"period": "day", "count": 1}, "detection_period": {"period": "day", "count": 7}, "column_name": "avg_price_rub", "model": "{{ get_where_subquery(ref('dm_prices_agg_dep_route')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_8dc82d391b_eleme__anomaly_scores__tmp_20251213082051831781\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-7' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}], "model.dbt_project.dm_prices_agg_search_dep_route": [{"metadata": {"test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "elementary_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6.None.row_count", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_agg_search_dep_route", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_agg_search_dep_route", "table_unique_id": "md_ticket.dm.dm_prices_agg_search_dep_route", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"time_bucket": {"period": "day", "count": 1}, "detection_period": {"period": "day", "count": 7}, "model": "{{ get_where_subquery(ref('dm_prices_agg_search_dep_route')) }}", "timestamp_column": "search_date", "where_expression": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "days_back": 14, "backfill_days": 7, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1", "exclude_detection_period_from_training": null}, "test_created_at": null, "description": null, "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "search_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-11-30T00:00:00", "end_time": "2025-12-01T00:00:00", "id": "a30edabee580085848782018ed8f199b", "metric_id": "3faf7dd63e2d82e8d2c94a69a95dd633", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-11-30T00:00:00", "bucket_end": "2025-12-01T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 2, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-01T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-01T00:00:00", "end_time": "2025-12-02T00:00:00", "id": "e609d27035d56aa9cc8cf6e61a05c8b0", "metric_id": "f1878b2d3c932fc0ba23ee44be6256ce", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-01T00:00:00", "bucket_end": "2025-12-02T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 3, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-02T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-02T00:00:00", "end_time": "2025-12-03T00:00:00", "id": "5d86ba17d4bc243f39322d5b3a108fad", "metric_id": "e79233147397c5fdd9a36bdbc7cc9be4", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-02T00:00:00", "bucket_end": "2025-12-03T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 4, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-03T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-03T00:00:00", "end_time": "2025-12-04T00:00:00", "id": "c92f3caba8838f8521cc1c445cfc6bd4", "metric_id": "4eaff35c530ff19af40175e828de663d", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-03T00:00:00", "bucket_end": "2025-12-04T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 5, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-04T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-04T00:00:00", "end_time": "2025-12-05T00:00:00", "id": "f60eb84364cda817f3c84aa2be72b5c9", "metric_id": "bf89e1a610698afadac197384ff2933e", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-04T00:00:00", "bucket_end": "2025-12-05T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 6, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-05T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-05T00:00:00", "end_time": "2025-12-06T00:00:00", "id": "40c09e76170d6f4da7c2fc15f705e473", "metric_id": "f05a919bf975aa845f3aaed23362b507", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-05T00:00:00", "bucket_end": "2025-12-06T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 7, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-06T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-06T00:00:00", "end_time": "2025-12-07T00:00:00", "id": "ec3371ec976b808668f2da3349dcc5ad", "metric_id": "ce7fc8669627feddb14f6321813111a1", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-06T00:00:00", "bucket_end": "2025-12-07T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 8, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-07T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-07T00:00:00", "end_time": "2025-12-08T00:00:00", "id": "bd8126e8a1d459621c45d5712cc1e2db", "metric_id": "88193c5dcb157c5511cad06c1c6f33a6", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-07T00:00:00", "bucket_end": "2025-12-08T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 9, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-08T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-08T00:00:00", "end_time": "2025-12-09T00:00:00", "id": "0d4349543ffc45989b395f9bf53f9146", "metric_id": "a6cac92b6fb10d3adf2cab346e859a45", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-08T00:00:00", "bucket_end": "2025-12-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 10, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-09T00:00:00", "end_time": "2025-12-10T00:00:00", "id": "72da08ea403689767fa3c1b4841e48b2", "metric_id": "7548ee912d4b1a080e18386d78a4399e", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-09T00:00:00", "bucket_end": "2025-12-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 11, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-10T00:00:00", "end_time": "2025-12-11T00:00:00", "id": "9ab0aecfd942d76069d2f68a09e21ebb", "metric_id": "08f14a0c8e0bccfdf3909a21793f4538", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-10T00:00:00", "bucket_end": "2025-12-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 12, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-11T00:00:00", "end_time": "2025-12-12T00:00:00", "id": "3a08e78f3237013c9dee6824d1bac087", "metric_id": "76e32771e0af8128c3d7062c7ff946fb", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-11T00:00:00", "bucket_end": "2025-12-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 13, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}, {"value": 0, "average": 0, "min_value": 0, "max_value": 0, "start_time": "2025-12-12T00:00:00", "end_time": "2025-12-13T00:00:00", "id": "e1927be39ca80e6acfb783943e39f674", "metric_id": "3e235e9373339ab3ba54e00d89aea7bf", "test_execution_id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782.test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "detected_at": "2025-12-13T08:20:52.252565", "full_table_name": "MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE", "column_name": null, "metric_name": "row_count", "anomaly_score": 0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2025-12-12T00:00:00", "bucket_end": "2025-12-13T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0, "min_metric_value": 0, "max_metric_value": 0, "training_avg": 0, "training_stddev": 0, "training_set_size": 14, "training_start": "2025-11-30T00:00:00", "training_end": "2025-12-13T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2025-12-13T00:00:00", "is_anomalous": false}], "result_description": "The last row_count value is 0.000. The average for this metric is 0.000."}}], "model.dbt_project.my_second_dbt_model": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778", "elementary_unique_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778.id.generic", "database_name": "md_ticket", "schema_name": "raw", "table_name": "my_second_dbt_model", "column_name": "id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.my_second_dbt_model", "table_unique_id": "md_ticket.raw.my_second_dbt_model", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select id\nfrom \"md_ticket\".\"raw\".\"my_second_dbt_model\"\nwhere id is null", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select id\nfrom \"md_ticket\".\"raw\".\"my_second_dbt_model\"\nwhere id is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": null, "error_message": null, "failed_rows_count": -1}}, {"metadata": {"test_unique_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493", "elementary_unique_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493.id.generic", "database_name": "md_ticket", "schema_name": "raw", "table_name": "my_second_dbt_model", "column_name": "id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.my_second_dbt_model", "table_unique_id": "md_ticket.raw.my_second_dbt_model", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"raw\".\"my_second_dbt_model\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"raw\".\"my_second_dbt_model\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1"}, "configuration": {"test_name": "unique", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}}}, "test_results": {"display_name": "unique", "results_sample": null, "error_message": null, "failed_rows_count": -1}}], "model.dbt_project.ods_ticket_offers": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_ods_ticket_offers_destination.bf21d909bf", "elementary_unique_id": "test.dbt_project.not_null_ods_ticket_offers_destination.bf21d909bf.destination.generic", "database_name": "md_ticket", "schema_name": "ods", "table_name": "ods_ticket_offers", "column_name": "destination", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.ods_ticket_offers", "table_unique_id": "md_ticket.ods.ods_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select destination\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere destination is null", "test_params": {"column_name": "destination", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select destination\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere destination is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "destination", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": null, "error_message": null, "failed_rows_count": -1}}, {"metadata": {"test_unique_id": "test.dbt_project.not_null_ods_ticket_offers_origin.5dd4583664", "elementary_unique_id": "test.dbt_project.not_null_ods_ticket_offers_origin.5dd4583664.origin.generic", "database_name": "md_ticket", "schema_name": "ods", "table_name": "ods_ticket_offers", "column_name": "origin", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.ods_ticket_offers", "table_unique_id": "md_ticket.ods.ods_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select origin\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere origin is null", "test_params": {"column_name": "origin", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select origin\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere origin is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "origin", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": null, "error_message": null, "failed_rows_count": -1}}, {"metadata": {"test_unique_id": "test.dbt_project.not_null_ods_ticket_offers_search_date.b6f8a4effb", "elementary_unique_id": "test.dbt_project.not_null_ods_ticket_offers_search_date.b6f8a4effb.search_date.generic", "database_name": "md_ticket", "schema_name": "ods", "table_name": "ods_ticket_offers", "column_name": "search_date", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.ods_ticket_offers", "table_unique_id": "md_ticket.ods.ods_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select search_date\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere search_date is null", "test_params": {"column_name": "search_date", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select search_date\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere search_date is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "search_date", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": null, "error_message": null, "failed_rows_count": -1}}], "model.dbt_project.dm_prices_latest": [{"metadata": {"test_unique_id": "test.dbt_project.elementary_all_columns_anomalies_dm_prices_latest_day__14__day__1.48663035ff", "elementary_unique_id": "test.dbt_project.elementary_all_columns_anomalies_dm_prices_latest_day__14__day__1.48663035ff.None.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_latest", "column_name": null, "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_latest", "table_unique_id": "md_ticket.dm.dm_prices_latest", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_48663035ff_eleme__anomaly_scores__tmp_20251213082051628787\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"time_bucket": {"period": "day", "count": 1}, "detection_period": {"period": "day", "count": 14}, "model": "{{ get_where_subquery(ref('dm_prices_latest')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_48663035ff_eleme__anomaly_scores__tmp_20251213082051628787\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "all_columns_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}, {"metadata": {"test_unique_id": "test.dbt_project.not_null_dm_prices_latest_price_rub.47d83d5149", "elementary_unique_id": "test.dbt_project.not_null_dm_prices_latest_price_rub.47d83d5149.price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_latest", "column_name": "price_rub", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_latest", "table_unique_id": "md_ticket.dm.dm_prices_latest", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select price_rub\nfrom \"md_ticket\".\"dm\".\"dm_prices_latest\"\nwhere price_rub is null", "test_params": {"column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_prices_latest')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select price_rub\nfrom \"md_ticket\".\"dm\".\"dm_prices_latest\"\nwhere price_rub is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_prices_latest')) }}"}}}, "test_results": {"display_name": "not_null", "results_sample": null, "error_message": null, "failed_rows_count": -1}}, {"metadata": {"test_unique_id": "test.dbt_project.relationships_dm_prices_latest_aviasales_id__aviasales_id__ref_dm_fact_ticket_offers_.c18c767867", "elementary_unique_id": "test.dbt_project.relationships_dm_prices_latest_aviasales_id__aviasales_id__ref_dm_fact_ticket_offers_.c18c767867.aviasales_id.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_latest", "column_name": "aviasales_id", "test_name": "relationships", "test_display_name": "Relationships", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_latest", "table_unique_id": "md_ticket.dm.dm_prices_latest", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "with child as (\n    select aviasales_id as from_field\n    from \"md_ticket\".\"dm\".\"dm_prices_latest\"\n    where aviasales_id is not null\n),\n\nparent as (\n    select aviasales_id as to_field\n    from \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null", "test_params": {"to": "ref('dm_fact_ticket_offers')", "field": "aviasales_id", "column_name": "aviasales_id", "model": "{{ get_where_subquery(ref('dm_prices_latest')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "with child as (\n    select aviasales_id as from_field\n    from \"md_ticket\".\"dm\".\"dm_prices_latest\"\n    where aviasales_id is not null\n),\n\nparent as (\n    select aviasales_id as to_field\n    from \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null"}, "configuration": {"test_name": "relationships", "test_params": {"to": "ref('dm_fact_ticket_offers')", "field": "aviasales_id", "column_name": "aviasales_id", "model": "{{ get_where_subquery(ref('dm_prices_latest')) }}"}}}, "test_results": {"display_name": "relationships", "results_sample": null, "error_message": null, "failed_rows_count": -1}}]}, "test_results_totals": {"model.dbt_project.stg_ticket_offers": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.dbt_project.dm_airports": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.dbt_project.dm_fact_ticket_offers": {"errors": 0, "warnings": 0, "passed": 7, "failures": 0}, "model.dbt_project.my_first_dbt_model": {"errors": 0, "warnings": 0, "passed": 1, "failures": 1}, "model.dbt_project.dm_prices_agg_route": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.dbt_project.dm_prices_agg_dep_route": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.dbt_project.dm_prices_agg_search_dep_route": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.dbt_project.my_second_dbt_model": {"errors": 0, "warnings": 0, "passed": 2, "failures": 0}, "model.dbt_project.ods_ticket_offers": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.dbt_project.dm_prices_latest": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}}, "test_runs": {"model.dbt_project.stg_ticket_offers": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_stg_ticket_offers_request.a705032bb7", "elementary_unique_id": "test.dbt_project.not_null_stg_ticket_offers_request.a705032bb7.request.generic", "database_name": "md_ticket", "schema_name": "stg", "table_name": "stg_ticket_offers", "column_name": "request", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.stg_ticket_offers", "table_unique_id": "md_ticket.stg.stg_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select request\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere request is null", "test_params": {"column_name": "request", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select request\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere request is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "request", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.not_null_stg_ticket_offers_response.51dbe8795c", "elementary_unique_id": "test.dbt_project.not_null_stg_ticket_offers_response.51dbe8795c.response.generic", "database_name": "md_ticket", "schema_name": "stg", "table_name": "stg_ticket_offers", "column_name": "response", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.stg_ticket_offers", "table_unique_id": "md_ticket.stg.stg_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select response\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere response is null", "test_params": {"column_name": "response", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select response\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere response is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "response", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.unique_stg_ticket_offers_aviasales_id.e16a27efc3", "elementary_unique_id": "test.dbt_project.unique_stg_ticket_offers_aviasales_id.e16a27efc3.aviasales_id.generic", "database_name": "md_ticket", "schema_name": "stg", "table_name": "stg_ticket_offers", "column_name": "aviasales_id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.stg_ticket_offers", "table_unique_id": "md_ticket.stg.stg_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select\n    aviasales_id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere aviasales_id is not null\ngroup by aviasales_id\nhaving count(*) > 1", "test_params": {"column_name": "aviasales_id", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select\n    aviasales_id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"stg\".\"stg_ticket_offers\"\nwhere aviasales_id is not null\ngroup by aviasales_id\nhaving count(*) > 1"}, "configuration": {"test_name": "unique", "test_params": {"column_name": "aviasales_id", "model": "{{ get_where_subquery(ref('stg_ticket_offers')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}], "model.dbt_project.dm_airports": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_dm_airports_airport_code.972fe3f0e8", "elementary_unique_id": "test.dbt_project.not_null_dm_airports_airport_code.972fe3f0e8.airport_code.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_airports", "column_name": "airport_code", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_airports", "table_unique_id": "md_ticket.dm.dm_airports", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select airport_code\nfrom \"md_ticket\".\"dm\".\"dm_airports\"\nwhere airport_code is null", "test_params": {"column_name": "airport_code", "model": "{{ get_where_subquery(ref('dm_airports')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select airport_code\nfrom \"md_ticket\".\"dm\".\"dm_airports\"\nwhere airport_code is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "airport_code", "model": "{{ get_where_subquery(ref('dm_airports')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}], "model.dbt_project.dm_fact_ticket_offers": [{"metadata": {"test_unique_id": "test.dbt_project.dbt_utils_accepted_range_dm_fact_ticket_offers_price_rub__0.438f520265", "elementary_unique_id": "test.dbt_project.dbt_utils_accepted_range_dm_fact_ticket_offers_price_rub__0.438f520265.price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": "price_rub", "test_name": "accepted_range", "test_display_name": "Accepted Range", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "with meet_condition as(\n  select *\n  from \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not price_rub >= 0\n)\n\nselect *\nfrom validation_errors", "test_params": {"min_value": 0, "column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "with meet_condition as(\n  select *\n  from \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not price_rub >= 0\n)\n\nselect *\nfrom validation_errors"}, "configuration": {"test_name": "accepted_range", "test_params": {"min_value": 0, "column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.elementary_column_anomalies_dm_fact_ticket_offers_price_rub__hour__12__day__14__hour__12.4d8a967773", "elementary_unique_id": "test.dbt_project.elementary_column_anomalies_dm_fact_ticket_offers_price_rub__hour__12__day__14__hour__12.4d8a967773.price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": "price_rub", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_4d8a967773_eleme__anomaly_scores__tmp_20251213082051764838\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"time_bucket": {"period": "hour", "count": 12}, "detection_period": {"period": "day", "count": 14}, "detection_delay": {"period": "hour", "count": 12}, "column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_4d8a967773_eleme__anomaly_scores__tmp_20251213082051764838\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "12 hours", "anomaly_threshold": null}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.elementary_dimension_anomalies_dm_fact_ticket_offers_hour__12__day__14__status_code__endpoint__currency__price_bucket__transfers_cnt__is_direct__hour__12.3d7b158c6b", "elementary_unique_id": "test.dbt_project.elementary_dimension_anomalies_dm_fact_ticket_offers_hour__12__day__14__status_code__endpoint__currency__price_bucket__transfers_cnt__is_direct__hour__12.3d7b158c6b", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": null, "test_name": "dimension_anomalies", "test_display_name": "Dimension Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_3d7b158c6b_eleme__anomaly_scores__tmp_20251213082051903719\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"dimensions": ["status_code", "endpoint", "currency", "price_bucket", "transfers_cnt", "is_direct"], "time_bucket": {"period": "hour", "count": 12}, "detection_period": {"period": "day", "count": 14}, "detection_delay": {"period": "hour", "count": 12}, "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_3d7b158c6b_eleme__anomaly_scores__tmp_20251213082051903719\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "dimension_anomalies", "timestamp_column": null, "testing_timeframe": "12 hours", "anomaly_threshold": null}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e", "elementary_unique_id": "test.dbt_project.elementary_event_freshness_anomalies_dm_fact_ticket_offers_hour__12__created_at__hour__12__processed_src_dttm.6ce50e966e.None.event_freshness", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": null, "test_name": "event_freshness_anomalies", "test_display_name": "Event Freshness Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "anomaly_detection", "test_sub_type": "event_freshness", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_FACT_TICKET_OFFERS' as varchar(4096))) and\n        metric_name = cast('event_freshness' as varchar(4096))", "test_params": {"event_timestamp_column": "created_at", "update_timestamp_column": "processed_src_dttm", "time_bucket": {"period": "hour", "count": 12}, "detection_delay": {"period": "hour", "count": 12}, "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}", "timestamp_column": "processed_src_dttm", "where_expression": null, "freshness_column": null, "dimensions": null, "days_back": 14, "backfill_days": 2, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1", "exclude_detection_period_from_training": null}, "test_created_at": null, "description": null, "result": {"result_description": "The last event_freshness value is 43200.000. The average for this metric is 43200.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_FACT_TICKET_OFFERS' as varchar(4096))) and\n        metric_name = cast('event_freshness' as varchar(4096))"}, "configuration": {"test_name": "event_freshness_anomalies", "timestamp_column": "processed_src_dttm", "testing_timeframe": "12 hours", "anomaly_threshold": 3}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.elementary_freshness_anomalies_dm_fact_ticket_offers_hour__12__day__7__hour__12.c57efa20b0", "elementary_unique_id": "test.dbt_project.elementary_freshness_anomalies_dm_fact_ticket_offers_hour__12__day__7__hour__12.c57efa20b0.None.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": null, "test_name": "freshness_anomalies", "test_display_name": "Freshness Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_c57efa20b0_eleme__anomaly_scores__tmp_20251213082052122536\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-7' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"time_bucket": {"period": "hour", "count": 12}, "detection_period": {"period": "day", "count": 7}, "detection_delay": {"period": "hour", "count": 12}, "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_c57efa20b0_eleme__anomaly_scores__tmp_20251213082052122536\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-7' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "freshness_anomalies", "timestamp_column": null, "testing_timeframe": "12 hours", "anomaly_threshold": null}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df", "elementary_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_fact_ticket_offers_hour__12__day__14__hour__12.0e2f84d6df.None.row_count", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_FACT_TICKET_OFFERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"time_bucket": {"period": "hour", "count": 12}, "detection_period": {"period": "day", "count": 14}, "detection_delay": {"period": "hour", "count": 12}, "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}", "timestamp_column": "created_at", "where_expression": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "days_back": 14, "backfill_days": 14, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1", "exclude_detection_period_from_training": null}, "test_created_at": null, "description": null, "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_FACT_TICKET_OFFERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "created_at", "testing_timeframe": "12 hours", "anomaly_threshold": 3}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.not_null_dm_fact_ticket_offers_price_rub.37637f5b0b", "elementary_unique_id": "test.dbt_project.not_null_dm_fact_ticket_offers_price_rub.37637f5b0b.price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_fact_ticket_offers", "column_name": "price_rub", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_fact_ticket_offers", "table_unique_id": "md_ticket.dm.dm_fact_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select price_rub\nfrom \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\nwhere price_rub is null", "test_params": {"column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select price_rub\nfrom \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\nwhere price_rub is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_fact_ticket_offers')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}], "model.dbt_project.my_first_dbt_model": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710", "elementary_unique_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710.id.generic", "database_name": "md_ticket", "schema_name": "raw", "table_name": "my_first_dbt_model", "column_name": "id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "fail", "model_unique_id": "model.dbt_project.my_first_dbt_model", "table_unique_id": "md_ticket.raw.my_first_dbt_model", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select id\nfrom \"md_ticket\".\"raw\".\"my_first_dbt_model\"\nwhere id is null", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": "Got 1 result, configured to fail if != 0", "result_query": "select id\nfrom \"md_ticket\".\"raw\".\"my_first_dbt_model\"\nwhere id is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}}}, "test_runs": {"fail_rate": 1.0, "totals": {"errors": 0, "warnings": 0, "passed": 0, "failures": 1}, "invocations": [{"affected_rows": 1, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "fail"}], "description": "There were 1 failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321", "elementary_unique_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321.id.generic", "database_name": "md_ticket", "schema_name": "raw", "table_name": "my_first_dbt_model", "column_name": "id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.my_first_dbt_model", "table_unique_id": "md_ticket.raw.my_first_dbt_model", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"raw\".\"my_first_dbt_model\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"raw\".\"my_first_dbt_model\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1"}, "configuration": {"test_name": "unique", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}], "model.dbt_project.dm_prices_agg_route": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_dm_prices_agg_route_avg_price_rub.7834ad96ee", "elementary_unique_id": "test.dbt_project.not_null_dm_prices_agg_route_avg_price_rub.7834ad96ee.avg_price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_agg_route", "column_name": "avg_price_rub", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_agg_route", "table_unique_id": "md_ticket.dm.dm_prices_agg_route", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select avg_price_rub\nfrom \"md_ticket\".\"dm\".\"dm_prices_agg_route\"\nwhere avg_price_rub is null", "test_params": {"column_name": "avg_price_rub", "model": "{{ get_where_subquery(ref('dm_prices_agg_route')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select avg_price_rub\nfrom \"md_ticket\".\"dm\".\"dm_prices_agg_route\"\nwhere avg_price_rub is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "avg_price_rub", "model": "{{ get_where_subquery(ref('dm_prices_agg_route')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}], "model.dbt_project.dm_prices_agg_dep_route": [{"metadata": {"test_unique_id": "test.dbt_project.elementary_column_anomalies_dm_prices_agg_dep_route_avg_price_rub__day__7__day__1.8dc82d391b", "elementary_unique_id": "test.dbt_project.elementary_column_anomalies_dm_prices_agg_dep_route_avg_price_rub__day__7__day__1.8dc82d391b.avg_price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_agg_dep_route", "column_name": "avg_price_rub", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_agg_dep_route", "table_unique_id": "md_ticket.dm.dm_prices_agg_dep_route", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_8dc82d391b_eleme__anomaly_scores__tmp_20251213082051831781\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-7' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"time_bucket": {"period": "day", "count": 1}, "detection_period": {"period": "day", "count": 7}, "column_name": "avg_price_rub", "model": "{{ get_where_subquery(ref('dm_prices_agg_dep_route')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_8dc82d391b_eleme__anomaly_scores__tmp_20251213082051831781\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-7' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}], "model.dbt_project.dm_prices_agg_search_dep_route": [{"metadata": {"test_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6", "elementary_unique_id": "test.dbt_project.elementary_volume_anomalies_dm_prices_agg_search_dep_route_day__7__day__1.546a73b2f6.None.row_count", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_agg_search_dep_route", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_agg_search_dep_route", "table_unique_id": "md_ticket.dm.dm_prices_agg_search_dep_route", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"time_bucket": {"period": "day", "count": 1}, "detection_period": {"period": "day", "count": 7}, "model": "{{ get_where_subquery(ref('dm_prices_agg_search_dep_route')) }}", "timestamp_column": "search_date", "where_expression": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "days_back": 14, "backfill_days": 7, "anomaly_sensitivity": 3, "anomaly_direction": "both", "seasonality": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1", "exclude_detection_period_from_training": null}, "test_created_at": null, "description": null, "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('MD_TICKET.DM.DM_PRICES_AGG_SEARCH_DEP_ROUTE' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "search_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}], "model.dbt_project.my_second_dbt_model": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778", "elementary_unique_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778.id.generic", "database_name": "md_ticket", "schema_name": "raw", "table_name": "my_second_dbt_model", "column_name": "id", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.my_second_dbt_model", "table_unique_id": "md_ticket.raw.my_second_dbt_model", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select id\nfrom \"md_ticket\".\"raw\".\"my_second_dbt_model\"\nwhere id is null", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select id\nfrom \"md_ticket\".\"raw\".\"my_second_dbt_model\"\nwhere id is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493", "elementary_unique_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493.id.generic", "database_name": "md_ticket", "schema_name": "raw", "table_name": "my_second_dbt_model", "column_name": "id", "test_name": "unique", "test_display_name": "Unique", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.my_second_dbt_model", "table_unique_id": "md_ticket.raw.my_second_dbt_model", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"raw\".\"my_second_dbt_model\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"md_ticket\".\"raw\".\"my_second_dbt_model\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1"}, "configuration": {"test_name": "unique", "test_params": {"column_name": "id", "model": "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}], "model.dbt_project.ods_ticket_offers": [{"metadata": {"test_unique_id": "test.dbt_project.not_null_ods_ticket_offers_destination.bf21d909bf", "elementary_unique_id": "test.dbt_project.not_null_ods_ticket_offers_destination.bf21d909bf.destination.generic", "database_name": "md_ticket", "schema_name": "ods", "table_name": "ods_ticket_offers", "column_name": "destination", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.ods_ticket_offers", "table_unique_id": "md_ticket.ods.ods_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select destination\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere destination is null", "test_params": {"column_name": "destination", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select destination\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere destination is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "destination", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.not_null_ods_ticket_offers_origin.5dd4583664", "elementary_unique_id": "test.dbt_project.not_null_ods_ticket_offers_origin.5dd4583664.origin.generic", "database_name": "md_ticket", "schema_name": "ods", "table_name": "ods_ticket_offers", "column_name": "origin", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.ods_ticket_offers", "table_unique_id": "md_ticket.ods.ods_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select origin\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere origin is null", "test_params": {"column_name": "origin", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select origin\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere origin is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "origin", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.not_null_ods_ticket_offers_search_date.b6f8a4effb", "elementary_unique_id": "test.dbt_project.not_null_ods_ticket_offers_search_date.b6f8a4effb.search_date.generic", "database_name": "md_ticket", "schema_name": "ods", "table_name": "ods_ticket_offers", "column_name": "search_date", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.ods_ticket_offers", "table_unique_id": "md_ticket.ods.ods_ticket_offers", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select search_date\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere search_date is null", "test_params": {"column_name": "search_date", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select search_date\nfrom \"md_ticket\".\"ods\".\"ods_ticket_offers\"\nwhere search_date is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "search_date", "model": "{{ get_where_subquery(ref('ods_ticket_offers')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}], "model.dbt_project.dm_prices_latest": [{"metadata": {"test_unique_id": "test.dbt_project.elementary_all_columns_anomalies_dm_prices_latest_day__14__day__1.48663035ff", "elementary_unique_id": "test.dbt_project.elementary_all_columns_anomalies_dm_prices_latest_day__14__day__1.48663035ff.None.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_latest", "column_name": null, "test_name": "all_columns_anomalies", "test_display_name": "All Columns Anomalies", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_latest", "table_unique_id": "md_ticket.dm.dm_prices_latest", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_48663035ff_eleme__anomaly_scores__tmp_20251213082051628787\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"time_bucket": {"period": "day", "count": 1}, "detection_period": {"period": "day", "count": 14}, "model": "{{ get_where_subquery(ref('dm_prices_latest')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || 'which is' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours without updates (only full buckets are considered). Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"md_ticket\".\"elementary\".\"test_48663035ff_eleme__anomaly_scores__tmp_20251213082051628787\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and\n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n\n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end > \n    cast(max_bucket_end as timestamp) + cast('-14' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n        select\n            metric_value as value,\n            training_avg as average,\n            \n            case\n                when is_anomalous = TRUE and 'both' = 'spike' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'spike' then\n                    \n    lag(min_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'spike' then metric_value\n                else min_metric_value\n            end as min_value,\n            case\n                when is_anomalous = TRUE and 'both' = 'drop' then\n                    \n    lag(metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when is_anomalous = TRUE and 'both' != 'drop' then\n                    \n    lag(max_metric_value, 1)\n over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n                when 'both' = 'drop' then metric_value\n                else max_metric_value\n            end as max_value,\n            bucket_start as start_time,\n            bucket_end as end_time,\n            *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n    )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "all_columns_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.not_null_dm_prices_latest_price_rub.47d83d5149", "elementary_unique_id": "test.dbt_project.not_null_dm_prices_latest_price_rub.47d83d5149.price_rub.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_latest", "column_name": "price_rub", "test_name": "not_null", "test_display_name": "Not Null", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_latest", "table_unique_id": "md_ticket.dm.dm_prices_latest", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "select price_rub\nfrom \"md_ticket\".\"dm\".\"dm_prices_latest\"\nwhere price_rub is null", "test_params": {"column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_prices_latest')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "select price_rub\nfrom \"md_ticket\".\"dm\".\"dm_prices_latest\"\nwhere price_rub is null"}, "configuration": {"test_name": "not_null", "test_params": {"column_name": "price_rub", "model": "{{ get_where_subquery(ref('dm_prices_latest')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}, {"metadata": {"test_unique_id": "test.dbt_project.relationships_dm_prices_latest_aviasales_id__aviasales_id__ref_dm_fact_ticket_offers_.c18c767867", "elementary_unique_id": "test.dbt_project.relationships_dm_prices_latest_aviasales_id__aviasales_id__ref_dm_fact_ticket_offers_.c18c767867.aviasales_id.generic", "database_name": "md_ticket", "schema_name": "dm", "table_name": "dm_prices_latest", "column_name": "aviasales_id", "test_name": "relationships", "test_display_name": "Relationships", "latest_run_time": "2025-12-13T08:20:52+00:00", "latest_run_time_utc": "2025-12-13T08:20:52+00:00", "latest_run_status": "pass", "model_unique_id": "model.dbt_project.dm_prices_latest", "table_unique_id": "md_ticket.dm.dm_prices_latest", "test_type": "dbt_test", "test_sub_type": "generic", "test_query": "with child as (\n    select aviasales_id as from_field\n    from \"md_ticket\".\"dm\".\"dm_prices_latest\"\n    where aviasales_id is not null\n),\n\nparent as (\n    select aviasales_id as to_field\n    from \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null", "test_params": {"to": "ref('dm_fact_ticket_offers')", "field": "aviasales_id", "column_name": "aviasales_id", "model": "{{ get_where_subquery(ref('dm_prices_latest')) }}"}, "test_created_at": null, "description": null, "result": {"result_description": null, "result_query": "with child as (\n    select aviasales_id as from_field\n    from \"md_ticket\".\"dm\".\"dm_prices_latest\"\n    where aviasales_id is not null\n),\n\nparent as (\n    select aviasales_id as to_field\n    from \"md_ticket\".\"dm\".\"dm_fact_ticket_offers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null"}, "configuration": {"test_name": "relationships", "test_params": {"to": "ref('dm_fact_ticket_offers')", "field": "aviasales_id", "column_name": "aviasales_id", "model": "{{ get_where_subquery(ref('dm_prices_latest')) }}"}}}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2025-12-13T08:20:52+00:00", "id": "a30a6a8c-ccbd-4735-8ced-5b2d7dd86782", "status": "pass"}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}}]}, "test_runs_totals": {"model.dbt_project.stg_ticket_offers": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.dbt_project.dm_airports": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.dbt_project.dm_fact_ticket_offers": {"errors": 0, "warnings": 0, "passed": 7, "failures": 0}, "model.dbt_project.my_first_dbt_model": {"errors": 0, "warnings": 0, "passed": 1, "failures": 1}, "model.dbt_project.dm_prices_agg_route": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.dbt_project.dm_prices_agg_dep_route": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.dbt_project.dm_prices_agg_search_dep_route": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.dbt_project.my_second_dbt_model": {"errors": 0, "warnings": 0, "passed": 2, "failures": 0}, "model.dbt_project.ods_ticket_offers": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.dbt_project.dm_prices_latest": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}}, "coverages": {"model.dbt_project.dm_airports": {"table_tests": 0, "column_tests": 1}, "model.dbt_project.dm_fact_ticket_offers": {"table_tests": 4, "column_tests": 3}, "model.dbt_project.dm_prices_agg_dep_route": {"table_tests": 0, "column_tests": 1}, "model.dbt_project.dm_prices_agg_route": {"table_tests": 0, "column_tests": 1}, "model.dbt_project.dm_prices_agg_search_dep_route": {"table_tests": 1, "column_tests": 0}, "model.dbt_project.dm_prices_latest": {"table_tests": 1, "column_tests": 2}, "model.dbt_project.my_first_dbt_model": {"table_tests": 0, "column_tests": 2}, "model.dbt_project.my_second_dbt_model": {"table_tests": 0, "column_tests": 2}, "model.dbt_project.ods_ticket_offers": {"table_tests": 0, "column_tests": 3}, "model.dbt_project.stg_ticket_offers": {"table_tests": 0, "column_tests": 3}}, "model_runs": [], "model_runs_totals": {}, "filters": {"test_results": [{"name": "failures", "display_name": "Failures", "model_unique_ids": ["model.dbt_project.my_first_dbt_model"]}, {"name": "passed", "display_name": "Passed", "model_unique_ids": ["model.dbt_project.stg_ticket_offers", "model.dbt_project.dm_airports", "model.dbt_project.dm_fact_ticket_offers", "model.dbt_project.my_first_dbt_model", "model.dbt_project.dm_prices_agg_route", "model.dbt_project.dm_prices_agg_dep_route", "model.dbt_project.dm_prices_agg_search_dep_route", "model.dbt_project.my_second_dbt_model", "model.dbt_project.ods_ticket_offers", "model.dbt_project.dm_prices_latest"]}, {"name": "no_test", "display_name": "No Tests", "model_unique_ids": ["source.dbt_project.raw_data.aviasales_api_log"]}], "test_runs": [{"name": "failures", "display_name": "Failures", "model_unique_ids": ["model.dbt_project.my_first_dbt_model"]}, {"name": "passed", "display_name": "Passed", "model_unique_ids": ["model.dbt_project.stg_ticket_offers", "model.dbt_project.dm_airports", "model.dbt_project.dm_fact_ticket_offers", "model.dbt_project.my_first_dbt_model", "model.dbt_project.dm_prices_agg_route", "model.dbt_project.dm_prices_agg_dep_route", "model.dbt_project.dm_prices_agg_search_dep_route", "model.dbt_project.my_second_dbt_model", "model.dbt_project.ods_ticket_offers", "model.dbt_project.dm_prices_latest"]}, {"name": "no_test", "display_name": "No Tests", "model_unique_ids": ["source.dbt_project.raw_data.aviasales_api_log"]}], "model_runs": []}, "lineage": {"nodes": [{"id": "model.dbt_project.ods_ticket_offers", "type": "model"}, {"id": "model.dbt_project.my_first_dbt_model", "type": "model"}, {"id": "model.dbt_project.my_second_dbt_model", "type": "model"}, {"id": "model.dbt_project.dm_prices_agg_search_dep_route", "type": "model"}, {"id": "model.dbt_project.dm_prices_agg_route", "type": "model"}, {"id": "model.dbt_project.dm_fact_ticket_offers", "type": "model"}, {"id": "model.dbt_project.dm_prices_agg_dep_route", "type": "model"}, {"id": "model.dbt_project.dm_prices_latest", "type": "model"}, {"id": "model.dbt_project.dm_airports", "type": "model"}, {"id": "model.dbt_project.stg_ticket_offers", "type": "model"}, {"id": "source.dbt_project.raw_data.aviasales_api_log", "type": "source"}], "edges": [["model.dbt_project.ods_ticket_offers", "model.dbt_project.stg_ticket_offers"], ["model.dbt_project.stg_ticket_offers", "source.dbt_project.raw_data.aviasales_api_log"], ["model.dbt_project.my_second_dbt_model", "model.dbt_project.my_first_dbt_model"], ["model.dbt_project.dm_prices_agg_search_dep_route", "model.dbt_project.dm_fact_ticket_offers"], ["model.dbt_project.dm_fact_ticket_offers", "model.dbt_project.ods_ticket_offers"], ["model.dbt_project.dm_prices_agg_route", "model.dbt_project.dm_fact_ticket_offers"], ["model.dbt_project.dm_prices_agg_dep_route", "model.dbt_project.dm_fact_ticket_offers"], ["model.dbt_project.dm_prices_latest", "model.dbt_project.dm_fact_ticket_offers"], ["model.dbt_project.dm_airports", "model.dbt_project.dm_fact_ticket_offers"]]}, "invocations": [{"invocation_id": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "detected_at": null, "command": "run", "selected": "", "full_refresh": false, "job_url": "None/dags/None/grid", "job_name": null, "job_id": null, "orchestrator": "airflow"}], "resources_latest_invocation": {"model.dbt_project.dm_airports": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.dbt_project.dm_fact_ticket_offers": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.dbt_project.dm_prices_agg_dep_route": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.dbt_project.dm_prices_agg_route": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.dbt_project.dm_prices_agg_search_dep_route": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.dbt_project.dm_prices_latest": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.dbt_project.my_first_dbt_model": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.dbt_project.my_second_dbt_model": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.dbt_project.ods_ticket_offers": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.dbt_project.stg_ticket_offers": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.alerts_anomaly_detection": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.alerts_dbt_models": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.alerts_dbt_source_freshness": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.alerts_dbt_tests": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.alerts_schema_changes": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.anomaly_threshold_sensitivity": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.data_monitoring_metrics": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_artifacts_hashes": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_columns": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_exposures": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_groups": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_invocations": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_metrics": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_models": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_run_results": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_seeds": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_snapshots": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_source_freshness_results": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_sources": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.dbt_tests": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.elementary_test_results": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.job_run_results": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.metadata": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.metrics_anomaly_score": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.model_run_results": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.monitors_runs": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.schema_columns_snapshot": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.seed_run_results": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.snapshot_run_results": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304", "model.elementary.test_result_rows": "9ff0662e-fd60-4984-a10d-0b0c4a6ec304"}, "invocations_job_identification": {}, "env": {"project_name": "dbt_project", "env": "dev", "warehouse_type": "postgres"}, "tracking": {"posthog_api_key": "phc_56XBEzZmh02mGkadqLiYW51eECyYKWPyecVwkGdGUfg", "report_generator_anonymous_user_id": "9b186bce-38a9-40eb-961a-9a2a0254b4af", "anonymous_warehouse_id": "a942b37ccfaf5a813b1432caa209a43b9d144e47ad0de1549c289c253e556cd5"}}